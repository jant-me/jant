name: Reset Demo Data

on:
  schedule:
    # Run daily at 00:00 UTC
    - cron: "0 0 * * *"
  workflow_dispatch:
    inputs:
      confirm:
        description: 'Type "reset" to confirm data reset'
        required: true
        default: ""

jobs:
  reset:
    runs-on: ubuntu-latest
    name: Reset demo.jant.me data

    # For manual trigger, require confirmation
    if: github.event_name == 'schedule' || github.event.inputs.confirm == 'reset'

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup mise
        uses: jdx/mise-action@v2

      - name: Install dependencies
        run: pnpm install --frozen-lockfile

      - name: Reset demo data
        run: mise run demo-reset
        env:
          CLOUDFLARE_API_TOKEN: ${{ secrets.CF_API_TOKEN }}
          CLOUDFLARE_ACCOUNT_ID: ${{ secrets.CF_ACCOUNT_ID }}
